
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Moviepoint - Online Movie,Vedio and TV Show HTML Template</title>
		<!-- Favicon Icon -->
		<link rel="icon" type="image/png" href="/web/assets/img/favcion.png" />
		<!-- Bootstrap CSS -->
		<link rel="stylesheet" type="text/css" href="/web/assets/css/bootstrap.min.css" media="all" />
		<!-- Slick nav CSS -->
		<link rel="stylesheet" type="text/css" href="/web/assets/css/slicknav.min.css" media="all" />
		<!-- Iconfont CSS -->
		<link rel="stylesheet" type="text/css" href="/web/assets/css/icofont.css" media="all" />
		<!-- Owl carousel CSS -->
		<link rel="stylesheet" type="text/css" href="/web/assets/css/owl.carousel.css">
		<!-- Popup CSS -->
		<link rel="stylesheet" type="text/css" href="/web/assets/css/magnific-popup.css">
		<!-- Main style CSS -->
		<link rel="stylesheet" href="/web/ltcss/style.css">
		<link href="/web/css/bootstrap.css" rel="stylesheet" type="text/css" media="all"/>
		<!-- Responsive CSS -->
		<link rel="stylesheet" type="text/css" href="/web/assets/css/responsive.css" media="all" />
		<!--自定义样式-->
		<link rel="stylesheet" type="text/css" href="/web/css/movieinfostyle.css">
		<link type="text/css" rel="stylesheet" href="/web/tao/css/citystyle.css"/>
		<link type="text/css" rel="stylesheet" href="/web/css/mtypestyle.css"/>

		<!--[if lt IE 9]>

		  <script src="http://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
		  <script src="http://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
			<![endif]-->
		<link href="/web/tao/css/star-rating.css" media="all" rel="stylesheet" type="text/css"/>
		<link rel="stylesheet" href="/web/ltcss/style1.css">
		<link rel="icon" type="image/png" href="/web/assets/img/favcion.png"/>
		<link rel="stylesheet" type="text/css" href="/web/assets/css/icofont.css" media="all"/>
	</head>
	<body style="background-color: #0a0910">
	<!--
        作者：offline
        时间：2019-09-09
        描述：头部
    -->
	<div id="apphead">
		<!-- header -->
		<header  class="header" >
			<div class="container">
				<div class="header-area">
					<div class="logo">
						<a href="/web/feng/index.html"><img   src="/web/assets/img/logo.png" alt="logo"/></a>
					</div>
					<div class="menu-area">
						<div class="responsive-menu"></div>
						<div class="mainmenu">
							<ul id="primary-menu">
								<li><a  href="/web/feng/index.html">首页</a></li>
								<li><a href="/web/tao/mtype.html">电影</a></li>
								<li><a href="/web/tao/cinema-jump.html">影城</a></li>
								<li><a href="/web/feng/hotmovies2.html">热映电影</a></li>
								<li><a href="https://ent.sina.com.cn/film/">热点</a></li>
								<li><a href="#">帮助 <i class="icofont icofont-simple-down"></i></a>
									<ul>
										<li><a onclick="showModel()" href="#">用户须知</a></li>
										<li><a href="#">联系客服</a></li>
									</ul>
								</li>
								<li v-show="user.username==null"><a class="login-popup" href="#" >登录</a>
									<!--<a  v-show="username!=null" v-text="username" >登录</a>-->
								</li>
								<li v-show="user.username==null" style="margin-left: 5px"><a class="register-popup" href="#">注册</a></li>
								<li style="margin-right: 10px" v-show="!user.username==''" id="user-center">
									<img v-show="user.upic==''" src="/web/ltimg/defaultpic.png" style="width: 32px;height: 32px;border-radius:50%">
									<img v-show="!user.upic==''" :src="user.upic" style="width: 32px;height: 32px;border-radius:50%">
									<a href="javascript:;" v-text="user.username"></a>
									<ul class="person-ul" style="display: block" >
										<li style="width: 100px"><a class="person-li" href="/web/profile/orders.html">个人中心</a></li>

										<li><a class="person-li" href="javascript:;" onclick="userlogout()">退出</a></li>
									</ul>
								</li>
								<!--<li><a class="theme-btn" href="#"><i class="icofont icofont-ticket"></i> 购票</a></li>-->
							</ul>
						</div>
					</div>
				</div>
			</div>
		</header>

		<div class="login-area" id="myidlogin">
			<div class="login-box">
				<a href="#"><i class="icofont icofont-close"></i></a>
				<h2 >登录</h2>
				<form  id ="logform" action="/api-user/user/login">
					<h6>用户名</h6>
					<input type="text" id="loginuser" name="username" placeholder="请输入用户名"/>
					<span id="ulmsg" class="msg"></span>
					<h6>密码</h6>
					<input type="password" id="loginpwd" name="password" placeholder="请输入密码"/>
					<span id="plmsg" class="msg"></span>
					<div>
						<div class="col-lg-8">
							<div style="float: left;">
                        <span class="hvr-shrink" style="color: blueviolet;font-size: 15px;font-family: 黑体;cursor: pointer" onclick="loginbyphone()">
                            <svg t="1569485567198" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1130" width="16" height="16"><path d="M717.72292 66.790172 310.008055 66.790172c-48.50676 0-87.971587 39.534412-87.971587 88.1302l0 48.489364 0 583.991638 0 78.821183c0 48.52518 39.463804 87.986937 87.971587 87.986937l407.714865 0c48.594765 0 88.1302-39.461757 88.1302-87.986937l0-78.821183L805.85312 203.409736l0-48.489364C805.85312 106.325607 766.317685 66.790172 717.72292 66.790172M276.401656 257.772878l475.086276 0L751.487931 733.038232 276.401656 733.038232 276.401656 257.772878zM751.487931 866.222557c0 18.545378-15.148002 33.622772-33.765011 33.622772L310.008055 899.845329c-18.527982 0-33.606399-15.077394-33.606399-33.622772l0-78.821183 475.086276 0L751.487931 866.222557zM276.401656 203.409736l0-48.489364c0-18.61701 15.078417-33.766035 33.606399-33.766035l407.714865 0c18.61701 0 33.765011 15.149025 33.765011 33.766035l0 48.489364L276.401656 203.409736zM513.963213 893.085368c27.323299 0 49.480948-22.155603 49.480948-49.514717 0-27.324322-22.156626-49.479925-49.480948-49.479925-27.359115 0-49.498344 22.154579-49.498344 49.479925C464.464869 870.929766 486.603075 893.085368 513.963213 893.085368M546.667056 153.751756l-65.426105 0c-6.813173 0-12.33391 5.52176-12.33391 12.317537 0 6.830569 5.520737 12.352329 12.33391 12.352329l65.426105 0c6.795776 0 12.351306-5.52176 12.351306-12.352329C559.018362 159.273517 553.461809 153.751756 546.667056 153.751756" p-id="1131"></path></svg>
                            点我进入手机登陆
                        </span>
							</div>
						</div>
						<div class="col-lg-4">
							<div style="float: right;" class="login-remember">
								<input id="rem" name="rem" type="checkbox"/>
								<label for="rem" style="font-size: 15px;font-family: 'Franklin Gothic Medium';">记住我</label>
							</div>
						</div>
					</div>
					<a @click="login()" class="theme-btn">登录</a>
				</form>
			</div>
		</div>
		<div style="display: none;" class="login-area" id="myphonelogin">
			<div class="login-box">
				<a href="#"><i class="icofont icofont-close"></i></a>
				<h2 >登录</h2>
				<form  id ="telform" action="/api-user/user/login">
					<h6>手机号</h6>
					<input type="tel" id="phonenum" name="telphone" placeholder="请输入手机号"/>
					<span id="telmsg" class="msg"></span>
					<div>
						<input class="col-lg-8" id="mycode" type="text" placeholder="验证码..." style="border: none;outline: none;border-bottom: orange 5px solid">
						<input class=" btn btn-success" type="button" onclick="getcode(this)" style="font-size: 13px;text-align: center!important;float: right;margin-top: 10px;background-color: red" value="获取验证码">
						<span id="codemsg" class="msg"></span>
					</div>
					<div style="float: left;">
                    <span class="hvr-shrink" style="color: blueviolet;font-size: 15px;font-family: 黑体;cursor: pointer" onclick="loginbyid()">
                        <svg t="1569486963559" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2521" width="16" height="16"><path d="M939.904 821.333333a439.296 439.296 0 0 0-306.346667-317.994666 233.258667 233.258667 0 0 0 111.573334-198.869334c0-128.554667-104.576-233.173333-233.130667-233.173333S278.869333 175.914667 278.869333 304.469333a233.258667 233.258667 0 0 0 111.573334 198.869334 439.296 439.296 0 0 0-306.346667 317.994666 103.594667 103.594667 0 0 0 19.541333 89.088c21.034667 26.88 52.608 42.24 86.613334 42.24H833.706667a109.226667 109.226667 0 0 0 86.613333-42.24c20.138667-25.6 27.221333-58.069333 19.584-89.088zM330.069333 304.469333c0-100.352 81.621333-181.973333 181.930667-181.973333s181.930667 81.621333 181.930667 181.973333S612.352 486.4 512 486.4 330.069333 404.778667 330.069333 304.469333z m549.973334 574.421334a59.306667 59.306667 0 0 1-46.336 22.613333H190.250667a59.306667 59.306667 0 0 1-46.336-22.613333 52.096 52.096 0 0 1-10.154667-45.312C176.725333 659.328 332.245333 537.6 512 537.6s335.274667 121.728 378.197333 295.978667a52.053333 52.053333 0 0 1-10.154666 45.312z" p-id="2522" fill="#515151"></path></svg>
                        点我进入用户名登陆
                    </span>
					</div>
					<a @click="login()" class="theme-btn">手机登录</a>
				</form>
			</div>
		</div>
		<div class="login-area" id="myregister">
			<div class="login-box register-box">
				<a href="#"><i class="icofont icofont-close"></i></a>
				<h2 >注册</h2>
				<form id ="reform" action="/api-user/user/register">
					<h6>用户名</h6>
					<input class="name_input reginput" id="reguser" type="text" name="username" placeholder="请输入用户名"/>
					<span id="urmsg" class="msg">用户名不得全为数字，不含特殊字符，支持中文</span>
					<h6>密码</h6>
					<input class="pwd_input reginput" id="regpwd" type="password" name="password" placeholder="请输入密码"/>
					<span id="rpmsg" class="msg">密码不得少于6位</span>
					<h6>确认密码</h6>
					<input class="repwd_input reginput" id="repwd" type="password" name="repwd" placeholder="请确认密码"/>
					<span id="remsg" class="msg"></span>
					<div style="margin-bottom: 20px;">
						<h6>手机号</h6>
						<input class="tel_input reginput" id="sendphone" style="float: left" type="tel" name="telphone" placeholder="请输入手机号" />
						<span id="regtel" class="msg"></span>
						<div>
							<input class="col-lg-8" id="myregcode" type="text" name="code" placeholder="验证码..." style="border: none;outline: none;border-bottom: orange 5px solid">
							<input type="button" class="btn btn-danger" style="font-size: 13px;text-align: center!important;float: right;margin-top: 10px;background-color: red" onclick="getcode(this)" value="获取验证码">
							<span id="regcode" class="msg"></span>
						</div>
					</div>
					<div>
						<a @click="register()" class="theme-btn">注册</a>
					</div>
				</form>
			</div>
		</div>

	</div>
	<script src="/web/js/vue.js"></script>
	<script type="text/javascript" src="/web/js/jquery-2.1.4.min.js"></script>
	<script type="text/javascript">


		function showModel() {
			$(".buy-ticket").slideDown();
		}
		function loginbyphone() {
			$("#myidlogin").hide();
			$("#myphonelogin").show();
		}
		function loginbyid() {
			$("#myidlogin").show();
			$("#myphonelogin").hide();
		}
		var t ;
		function getcode(th) {
			$.ajax({
				url:"/api-user/user/sendCode",
				data:{"phone":$(th).parent().prev().prev().val()},
				dataType:"json",
				type:"get",
				success:function (rt) {
					$(th).attr("disabled","disabled");
					var second = 10;
					t = setInterval(function () {
						$(th).val(second+"s重发");
						second -= 1;
						console.log("second==="+second);
						if(second<=-1){
							$(th).removeAttr("disabled");
							$(th).val("获取验证码");
							clearInterval(t);60
						}
					},1000)
				}
			});
		}
		function userlogout() {
			$.ajax({
				url:"/api-user/user/userlogout",
				dataType:"json",
				type:"delete",
				success:function (rt) {
					if(rt.code=="success"){
						apphead.user = {};
						var mydate=new Date();
						mydate.setTime(-1000);
						document.cookie="loguser=0;path=/;expires="+new Date(0).toUTCString();
					}
				}
			});
		}



		window.onload=function () {
			$("#user-center").mouseover(function () {
				$(".person-ul").stop(true);
				$(".person-ul").slideDown(500);
			})
			$("#user-center").mouseleave(function () {
				$(".person-ul").stop(true);
				$(".person-ul").slideUp(500);
			})
			//用户名登录验证
			function lucheck() {
				var pattern = new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>《》/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]");
				/*var reg = new RegExp("[\\u4E00-\\u9FFF]+","g");*/
				if((/^[0-9]+$/.test($("#loginuser").val()))){
					$("#ulmsg").text("用户名不能全为数字")
				}else if(/^[a-zA-Z]+$/.test($("#loginuser").val())){
					$("#ulmsg").text("用户名不得全为字母")
				}else if($("#loginuser").val().length<2){
					$("#ulmsg").text("用户名不少于两位")
				}else if(pattern.test($("#loginuser").val())){
					$("#ulmsg").text("用户名不得含有特殊字符")
				}
			}
			//登录密码验证
			function lpwdcheck() {
				if($("#loginpwd").val().length<6){
					$("#plmsg").text("密码不得少于六位")
				}else if(/^[a-zA-Z]+$/.test($("#loginpwd").val())){
					$("#plmsg").text("密码不得全为字母")
				}
			}
			//登录手机号验证
			function lpcheck() {
				var myreg = /^1[3456789]\d{9}$/;
				if(!myreg.test($("#phonenum").val())){
					$("#telmsg").text("手机号码不合法")
				}
			}
			$("#loginuser").blur(function () {
				lucheck();
			})
			$("#loginuser").focus(function () {
				$("#ulmsg").empty();
			})
			$("#loginpwd").blur(function () {
				lpwdcheck();
			})
			$("#loginpwd").focus(function () {
				$("#plmsg").empty();
			})
			$("#phonenum").blur(function () {
				lpcheck();
			})
			$("#phonenum").focus(function () {
				$("#telmsg").empty();
			})
			//注册用户名验证
			function rucheck() {
				var pattern = new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>《》/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]");
				/*var reg = new RegExp("[\\u4E00-\\u9FFF]+","g");*/
				if((/^[0-9]+$/.test($("#reguser").val()))){
					$("#urmsg").text("用户名不能全为数字")
				}else if(pattern.test($("#reguser").val())){
					$("#urmsg").text("用户名不得含有特殊字符")
				}else if($("#reguser").val().length<2){
					$("#urmsg").text("用户名至少两位")
				}
			}
			//注册密码验证
			function rpwdcheck() {
				if($("#regpwd").val().length<6){
					$("#rmsg").text("密码不得少于六位")
				}else if(/^[a-zA-Z]+$/.test($("#loginpwd").val())){
					$("#rpmsg").text("密码不得全为字母")
				}
			}
			//注册密码确认验证
			function recheck() {
				if($("#repwd").val()!=$("#regpwd").val()){
					$("#remsg").text("密码输入不一致")
				}
			}
			//注册手机号验证
			function rpcheck() {
				var myreg = /^1[3456789]\d{9}$/;
				if(!myreg.test($("#sendphone").val())){
					$("#regtel").text("手机号码不合法")
				}
			}
			$("#reguser").blur(function () {
				rucheck();
			})
			$("#reguser").focus(function () {
				$("#urmsg").empty();
			})
			$("#regpwd").blur(function () {
				rpwdcheck();
			})
			$("#regpwd").focus(function () {
				$("#rpmsg").empty();
			})
			$("#repwd").blur(function () {
				recheck();
			})
			$("#repwd").focus(function () {
				$("#remsg").empty();
			})
			$("#phonenum").blur(function () {
				rpcheck();
			})
			$("#phonenum").focus(function () {
				$("#regtel").empty();
			})
			$("#mycode").focus(function () {
				$("#codemsg").empty();
			})
			$("#myregcode").focus(function () {
				$("#regcode").empty();
			})
		}

	</script>
	<script type="text/javascript">
		var apphead=new Vue({
			el:"#apphead",
			data:{
				user:{}
			},
			created:function () {
				var _this=this;
				var cookies=document.cookie.split(";");
				var myuser;
				var a = "loguser";
				for(var i=0;i<cookies.length;i++){
					if(a==cookies[i].split("=")[0].trim()){
						var user = cookies[i].split("=")[1];
						console.log("---"+user);
						myuser = decodeURIComponent(user);
						console.log("===="+myuser);
					}
				}
				if(myuser!=null){
					_this.user = $.parseJSON(myuser);
				}

			},
			methods: {
				login() {

					var obj = this;
					var flag = false;
					for(var i=0;i<$("#logform .msg").length;i++){
						if($("#logform .msg").eq(i).text()==null||$("#logform .msg").eq(i).text()==""){
							flag =true;
						}
					}
					for(var i=0;i<$("#telform .msg").length;i++){
						if($("#telform .msg").eq(i).text()==null||$("#telform .msg").eq(i).text()==""){
							flag =true;
						}
					}
					if(flag==true){
						$.ajax({
							url: "/api-user/user/login",
							data: {"username":$("#loginuser").val(),"password":$("#loginpwd").val(),
								"phonenum":$("#phonenum").val(),"code":$("#mycode").val()},
							type: "post",
							dataType: "json",
							success: function (data) {
								if (data.code = "success") {
									$(".login-area").slideUp(1000);
									obj.user = data.object;
								}else if(data.code=="error"){
									alert(data.message);
								}else if(data.code=="ufail"){
									$("#ulmsg").text(data.message);
								}else if(data.code=="pwdfail"){
									$("#plmsg").text(data.message);
								}else if(date.code=="pfail"){
									$("#telmsg").text(data.message);
								}else if(data.code=="cfail"){
									$("#codemsg").text(data.message);
								}else{
									alert(data.message);
								}

							}

						})
					}
				},
				register(){
					var v =this;
					if($(".msg").text()==null||$(".msg").text()==""){
						$.ajax({
							url:"/api-user/user/register",
							data:$("#reform").serialize(),
							type:"get",
							dataType:"json",
							success:function (rt) {
								alert(rt.message);
								window.location.reload();
							}
						});
					}
				}
			}
		})
	</script>
		<div id="app">
		<section class="breadcrumb-area">
			<div class="container">
				<div class="row">
					<div class="col-lg-12">
						<div class="breadcrumb-area-content">
							<h1>Movie Detalied Page</h1>
						</div>
					</div>
				</div>
			</div>
		</section><!-- breadcrumb area end -->
		<!-- transformers area start -->
		<section class="transformers-area">
			<div class="container">
				<div class="transformers-box">
					<div class="row flexbox-center">
						<div class="col-lg-5 text-lg-left text-center">
							<div class="transformers-content">
								<img :src="movie.mpic" alt="about" />
							</div>
						</div>
						<div class="col-lg-7">
							<div class="transformers-content">
								<h2 v-text="movie.mname">The Transformers</h2>
								<span v-for="type in movie.types">
									<span v-text="type.mtype"></span> |
								</span>
								<ul>
									<li>
										<div class="transformers-left">
											导演:
										</div>
										<div class="transformers-right">
											<span v-text="moviePerson.screenwriter"></span>
										</div>
									</li>
									<li>
										<div class="transformers-left">
											主演:
										</div>
										<div class="transformers-right">
											<span v-text="moviePerson.director"> </span>
										</div>
									</li>
									<li>
										<div class="transformers-left">
											时长:
										</div>
										<div class="transformers-right">
											<span v-text="movie.longtime">190</span>min
										</div>
									</li>
									<li>
										<div class="transformers-left">
											上映:
										</div>
										<div class="transformers-right">
											<span v-text="uptimes"></span>
										</div>
									</li>

								</ul>
							</div>
						</div>
					</div>
					<a :href="'/web/tao/cinema-jump.html?mid='+mid" class="theme-btn"><i class="icofont icofont-ticket"></i> 购票</a>
				</div>
			</div>
		</section><!-- transformers area end -->

		<!-- details area start -->
		<section class="details-area">
			<div class="container">
				<div class="row">
					<div class="col-lg-9">
						<div class="details-content">
							<div class="details-overview">
								<h2>详情介绍</h2>
								<span v-text="movie.shortStory"></span>
							</div>
							<span class="info-mtop2 info-display2"><h2>用户评论</h2></span>
							<!--评论信息展示-->
							<div>
								<!--评论用户信息-->
								<div v-for="comment in comments" class="info-mtop">
									<!--用户头像-->
									<img class="userimg" :src="comment.user.upic">
									<!--用户名称-->
									<span v-text="comment.user.username"></span>
									<!--用户评分-->
									<!--<span :id="'sc'+comment.id" class="info-mleft " v-text="comment.userScore"></span>-->
									<span v-for="i in comment.userScore">
										<img  class="commentimg" src="/web/tao/images/stars2.jpg">
									</span>
									<!--用户评论-->
									<div class="info-mleft" v-text="comment.argue"></div>
									<!--评论时间-->
									<span class="info-mleft" v-text="comment.time"></span>
									<!--点赞图标-->
									<span class="info-mleft" :id="'commentid'+comment.id" @click="addpraise($event,comment.id)"><img class="praiseimg" src="/web/images/zan1.jpg"></span>
									<!--点赞数量-->
									<span style="margin-left: 3px" v-text="comment.likeNum==0?' ':comment.likeNum"></span>
								</div>
							</div>
							<!--分页-->

							<div class="details-reply">
								<span style="cursor: pointer" onclick="show()"><h2>写下评论</h2></span>
								<a @click="prev()">上一页</a>
								<a  @click="next()">下一页</a>

								<!--<h2>评分</h2>-->
								<form action="#" class="info-display show">
									<div class="row">
										<div class="col-lg-12">
											<div class="textarea-container">
												<textarea id="argue" placeholder="写下你的观影感受吧"></textarea>
												<button><i class="icofont icofont-send-mail"></i></button>
											</div>
										</div>
									</div>
								</form>
							</div>
							<div class="details-comment show info-display">
								<span  @click="insertComment()" class="theme-btn theme-btn2" href="#">提交你的评论</span>

							</div>
						</div>
					</div>
					<div class="col-lg-3 text-center text-lg-left">
					    <div class="portfolio-sidebar">
							<img src="/web/assets/img/sidebar/sidebar1.png" alt="sidebar" />
							<img src="/web/assets/img/sidebar/sidebar2.png" alt="sidebar" />
							<img src="/web/assets/img/sidebar/sidebar4.png" alt="sidebar" />
						</div>
					</div>
				</div>
			</div>
		</section><!-- details area end -->
			<div class="footer">
				<div class="container">
					<div class="w3ls_footer_grid">
						<div class="col-md-6 w3ls_footer_grid_left">
							<div class="w3ls_footer_grid_left1">
								<h3>关于爱乐</h3>
								<div class="w3ls_footer_grid_left1_pos">
									<div class="bottom-row">
										<span>商务合作邮箱：971872973@qq.com</span>
										<span class="bt-line">|</span>
										<span>客服电话：17603649546</span>
									</div>
									<div class="bottom-row">
										<span>用户投诉邮箱：1099773854@qq.com</span>
										<span class="bt-line">|</span>
										<span>友情链接：<a href="https://cq.meituan.com/?utm_source=wwwmaoyan"
													  class="bottom-chain">美团网</a></span>
									</div>
									<div class="bottom-row">
										<a href="#" class="bottom-chain">中华人民共和国增值电信业务经营许可证&nbsp;渝A1-20190909</a>
									</div>
									<div class="bottom-row">
										<a href="#" class="bottom-chain">网络文化经营许可证&nbsp;京网文(2019)3897-330号</a>
									</div>
									<div class="bottom-row">
										<a href="#" class="bottom-chain">爱乐用户服务协议</a>
										<span class="bt-line">|</span>
										<a href="#" class="bottom-chain">爱乐平台交易规则总则</a>

									</div>
								</div>
							</div>
						</div>
						<div class="col-md-6 w3ls_footer_grid_right">
							<a href="index.html"><h2 class="title">爱乐<span class="webtitle-bottom">电影</span></h2></a>
						</div>
						<div class="clearfix"></div>
					</div>
					<div class="col-md-5 w3ls_footer_grid1_left">
						<p>重庆爱乐文化传媒有限公司©2016 爱乐电影 aiyue.com </p>
					</div>
					<div class="col-md-7 w3ls_footer_grid1_right">
						<div class="col-lg-6 card-left">
							<a href="#"><img src="/web/images/web-permission.png"/></a>

						</div>
						<div class="col-lg-6 card-right">
							<a href="#"><img src="/web/images/permission-card.png"/></a>
						</div>
					</div>
					<div class="clearfix"></div>
				</div>
			</div>
		</div>
		<!-- footer section start -->

		<!-- jquery main JS -->
		<script src="/web/assets/js/jquery.min.js"></script>
		<!--评分-->
		<!-- Bootstrap JS -->
		<script src="/web/assets/js/bootstrap.min.js"></script>
		<!-- Slick nav JS -->
		<script src="/web/assets/js/jquery.slicknav.min.js"></script>
		<!-- owl carousel JS -->
		<script src="/web/assets/js/owl.carousel.min.js"></script>
		<!-- Popup JS -->
		<script src="/web/assets/js/jquery.magnific-popup.min.js"></script>
		<!-- Isotope JS -->
		<script src="/web/assets/js/isotope.pkgd.min.js"></script>
		<!-- main JS -->
		<script src="/web/assets/js/main.js"></script>
		<script src="/web/js/vue.js"></script>
		<script src="/web/tao/js/jquery-1.9.1.min.js"></script>
		<script src="/web/tao/js/location.js"></script>
		<script src="/web/tao/js/city.js"></script>
		<script src="/web/tao/js/bscroll.min.js"></script>



		<script>
			var mid = location.href.split("=")[1].split("&")[0];
			var cid =location.href.split("=")[2];
			$(function () {
                // alert("文档就绪事件");
            });
			function  selectComment(_data) {
				$.ajax({
					url:"/api-comment/comment",
					data:{"cid":_data.cid ,"mid":_data.mid,"pageIndex":_data.page.pageIndex},
					type:"get",
					dataType:"json",
					success:function (data) {
						if(data.code=="success"){
							_data.comments=data.list;
							_data.page=data.object;
						}else{
							alert(data.message);
						}
					}
				});
			}
			var _data;
			var app=new Vue({
				el:"#app",
				data:{
				    movie:{},
                    moviePerson:{},
					user:{},
					comments:[],
					likes:[],
					mid:mid,
					cid:cid,

					uptimes:"",
					page:{}
				},
				created:function () {
					 _data=this;
					var cookies=document.cookie.split(";");
					var myuser;
					var a = "loguser";
					for(var i=0;i<cookies.length;i++){
						if(a==cookies[i].split("=")[0].trim()){
							var user = cookies[i].split("=")[1];
							console.log("---"+user);
							myuser = decodeURIComponent(user);
							console.log("===="+myuser);
						}
					}
					if(myuser!=null){
						_data.user = $.parseJSON(myuser);
					}
					/*获取电影id*/
					// alert(window.location);
					var mid=_data.mid;
					/*根据id查询电影详情*/
					$.ajax({
						url:"/movie-stage/movie/bymid/"+mid,
						type:"get",
						dataType:"json",
						success:function (data) {
							if(data.code=="success"){
							    _data.movie=data.object.movie;
							    _data.moviePerson=data.object.moviePerson;
							    _data.uptimes=getTime(_data.movie.uptime);
							}else{
							    alert(data.message);
							}
                        }
					});
					/*查询用户信息；*/
				/*	$.ajax({
						url:"/api-user/user",
						type:"get",
						dataType:"json",
						success:function (data) {
							if(data.code=="success"){
								_data.user=data.object;
							}else{
							    alert(data.message);
							}
                        }
					});*/
					/*查询评论集合*/
					selectComment(_data);


                },
				beforeUpdate:function(){
                    /*查询该用户所有点赞信息*/
                    $.ajax({
                        url:"/api-comment/like",
                        type:"get",
                        dataType:"json",
                        success:function (data) {
                            if(data.code=="success"){
                                _data.likes=data.list;
                                for (var i=0;i<_data.likes.length;i++) {
                                    $("#commentid"+_data.likes[i].commentId).children().eq(0).attr("src","/web/images/zan2.jpg");
                                }
                            }
                        }
                    });
				},
				methods:{
					prev(){
						var v = this;
						if(v.page.pageIndex>1){
							v.page.pageIndex=v.page.pageIndex-1;
							selectComment(v);
						}
					},
					next(){
						var v = this;
						if(v.page.pageIndex<v.page.pageCount){
							v.page.pageIndex=v.page.pageIndex+1;
							selectComment(v);
						}
					},
				    insertComment:function () {
				        var userScore=5;
				        var argue=$("#argue").val();
						$.ajax({
							url:"/api-comment/comment",
							type:"post",
							data:{"cid":_data.cid,"mid":_data.mid,"argue":argue,"userScore":userScore},
							dataType:"json",
							success:function (data) {
								if(data.code=="success"){
								    alert("success");
									window.location.reload(true)
								}else{
								    alert(data.message);
								}
                            }
						});
                    },
                    addpraise:function (e,cid) {
                        var num=$(e.target).parent().next().text();
                        if($(e.target).attr("src")=="/web/images/zan2.jpg"){
                            if(num>0){
                                $(e.target).parent().next().text(num-1);
                                if ($(e.target).parent().next().text()==0){
                                    $(e.target).parent().next().text(" ");
								}
							}
                            $(e.target).attr("src","/web/images/zan1.jpg");
                            /*取消赞*/
							$.ajax({
								url:"/api-comment/like/delete/"+cid,
								type:"delete",
								dataType:"json",
								success:function (data) {
									if(data.code=="success"){
									    // alert("success!");
									}else{
									    alert(data.message);
									}
                                }
							});
                        }else{
                            if(app.user.username!=null){
                                $(e.target).attr("src","/web/images/zan2.jpg");
                                $(e.target).parent().next().text(num-(-1));
							}
                            /*添加赞*/
                            $.ajax({
                                url:"/api-comment/like/"+cid,
                                type:"post",
                                dataType:"json",
                                success:function (data) {
                                    if(data.code=="success"){
                                        // alert("success");
                                    }else{
                                        alert(data.message);
                                    }
                                }
                            });
                        }
                    }
				}
			});
			/*评论文本域显示隐藏*/
			function show() {
				if($(".show").css("display")=="none"){
                    $(".show").css("display","block");
				}else{
                    $(".show").css("display","none");
				}
            }
            /**
             * 格式化时间
             * @param second
             * @param getDateType
             * @returns {string|number}
             */
			function getTime(second) {
				var date = new Date(second);
				var year = date.getFullYear()
				if ((date.getMonth() + 1) <= 9) {
					var month = "0" + (date.getMonth() + 1);
				} else {
					var month = date.getMonth() + 1;
				}
				if (date.getDate() <= 9) {
					var day = "0" + date.getDate();
				} else {
					var day = date.getDate();
				}
				if (date.getHours() <= 9) {
					var hour = "0" + date.getHours();
				} else {
					var hour = date.getHours();
				}
				if (date.getMinutes() <= 9) {
					var minutes = "0" + date.getMinutes();
				} else {
					var minutes = date.getMinutes();
				}
				if (date.getSeconds() <= 9) {
					var seconds = "0" + date.getSeconds();
				} else {
					var seconds = date.getSeconds();
				}
				return year + "-" + month + "-" + day;
			}



		</script>
	</body>
</html>
